# pentest-report
Module 16-17 Penetration Test Report

I named my ficticious business SolidCyber.

Executive Summary

SolidCyber performed a security assessment of MegaCorpOne to determine all areas of security risk within the network as per agreement in the statement of work (SoW). Our team performed penetration testing to provide this company with information about their security risk within their network environment.

The team started by performing passive reconnaissance with external sources to find out as much information about the company and its network as possible through search engines, and the company websites/pages. This information was collected, and we performed several tests on the ports, finding open ports, and services that were enabled like LLMNR. This gave the team the ability to list vulnerabilities that we could use to attack the systems. With a large list we were able to exploit them and compromise MegaCorpOne.

With the findings of many vulnerabilities, we created a list by severity. They should be resolved immediately to avoid being hacked or ransomed. Per our assessment your company is highly acceptable to these kinds of attacks as well as Denial-of-service (DoS), and Man-in-the-middle.


Vulnerability Findings

Weak Password on Public Web Application

Risk Rating: Critical

Description: 
The site vpn.megacorpone.com Fig 1 is used to host the Cisco AnyConnect configuration file for MegaCorpOne. This site is secured with basic authentication but is susceptible to dictionary attack. SC was able to use a username gathered from OSINT in combination with a wordlist to guess the user’s password and access the configuration file.

Fig 1. vpn.megacorpone.com files
 ![image](https://github.com/ReVampHer/pentest-report/assets/98286483/f2932bec-068f-4814-aba7-893e9a396b72)


Affected Hosts: vpn.megacorpone.com

Remediation: 

●	Set up two-factor authentication instead of basic authentication to prevent dictionary attacks from being successful.
●	Require a strong password complexity that requires passwords to be over 12 characters long, upper + lower case, & include a special character.
●	Reset the user thudson’s password.


Vulnerable Open Ports on the network

Risk Rating: Critical 

Description:
A Zenmap scan was performed to find open ports to identify possible vulnerable systems, and or applications in Fig 1. We found a back door exploit using Searchsploit in Fig 2A “21/tcp open ftp vsftpd” and that it was verified in Fig 4 with “vsftpd 2.3.4 Backdoor Command Execution unix/remote/49757.py”. We were able to access 172.22.117.150 and run “whoami” and verified access to “root”. Fig 3 shows the open ports on 172.22.117.10. Fig 5 is the script that was run to perform the exploit. And Fig 6 Searchsploit: Oracle windows, and Linux kernel 4.4 with an exclude.

Fig 1. Scan results for 172.22.117.100/24 
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/16ff6d98-d223-4c27-b3df-6a02b800a524)

Fig 2A. Scan results for 172.22.117.150
 ![image](https://github.com/ReVampHer/pentest-report/assets/98286483/c37f7a70-9cbb-4365-ad5a-a637718c3a96)

Fig 2B. Scan results for 172.22.117.150
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/d600dbfa-ec97-458a-89f0-965edb5f50f2)
 
Fig 2C. Scan results for 172.22.117.150
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/fd7d2037-16f5-40e6-89ce-b146cd42cab3)

Fig 3. Scan results including 172.22.117.10
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/c0b36ac0-a50a-4168-8db2-6b15a360ad50)
 
Fig 4. Searchsploit results: Exploit vsftpd  
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/a3f11262-223c-455a-a9ea-de90d6f2f7ca)

Fig 5. Script

![image](https://github.com/ReVampHer/pentest-report/assets/98286483/af86e384-2fe8-49b9-9c66-c12b7530dda8)

Fig 6. Searchsploit: Oracle windows, and Linux kernel 4.4 with an exclude.
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/21a3963e-32f5-424b-98ae-e3609a54470a)
 
Affected Hosts: megacorpone.com

Remediation: 
•	Close commonly abused ports if not in use/needed and create access rules.
•	Perform network vulnerability and port scans regularly.
•	Keep up to date with available CVE information.
•	Install firewalls.


Exploiting and Privilege Escalation

Risk Rating: Critical 

Description: We performed a search on all files/folders within a linux terminal revealing a file named “adminpassword.txt” Fig 2. It was found by using a find command Fig 1, of “find / -type f -iname “*admin*.txt” in the directories of “/var/tmp/adminpassword.txt”. The name of the text file appeared to be storing password information. We further reviewed the file Fig 3, and it appeared as if it was admin credentials, and they were being shared between two users. We were able to SSH Fig 4, and escalate our access to a “root” shell with the command of “ssh msfadmin@172.22.117.150”

Fig 1. find command using “admin.”
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/051b5990-8d23-4153-b296-c0d43ad4e23e)
 
Fig 2. admin file

![image](https://github.com/ReVampHer/pentest-report/assets/98286483/1fbcaf59-8f01-470d-9413-25ffa9f4a678)
 
Fig 3. Cat of admin file
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/3ddcf3be-7bbe-4425-b82c-dac788838ac8)
 
Fig 4. SSH, escalate access to a “root”. 
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/70cd358b-9a92-4925-9578-e6ab33367a28)
 

Affected Hosts: megacorpone.com

Remediation: 
•	Educate users to not store or share passwords.
•	Implement least privileged access rights.
•	Use multi-factor authentication.
•	Harden systems and applications.
•	Implement IDS/IPS (Intrusion detection system/Intrusion prevention system)

LLMNR Spoofing Vulnerability

Risk Rating: Critical 

Description: Local Link Multicast Name Resolution is a local backup for Domain Name System. This service is shown turned on via Fig 1. Hackers can listen for this protocol and spoof the response while collecting the user’s information to access the network. We were able to obtain additional user information as seen in Fig 2, and from Fig 3 John the Ripper cracked the password.txt file.

Fig 1. LLMNR is ON

![image](https://github.com/ReVampHer/pentest-report/assets/98286483/8a2c58b5-fa70-45a8-bbf7-a7a900a7eeed)
 

Fig 2. Additional Username and password hash
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/2c91907b-42c1-4ba4-b7e1-7c1a1a7540e1)
 

Fig 3. John the Ripper cracked the password.txt file.
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/4f2df2ac-d61a-4462-abf3-0eb91a536b54)
 

Remediation: 
•	Monitor network traffic.
•	Disable LLMNR
•	Use user group policies.
•	Patch Management/System Hardening
•	Implement password policies.

Password Cracking

Risk Rating: Critical 

Description: My team SSH Fig 1 into the system with the credentials of “ssh msfadmin@172.22.117.150 with the password “cybersecurity”.  Afterwards we collected the hashes Fig 2 for the users from the shadow file and created a hashes.txt file. We proceeded by using a password cracking tool “John the Ripper” Fig 3, and all the passwords were cracked successfully. 
  

Fig 1. SSH into system
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/ba46f743-dfb4-4c54-8401-3a39dd46fdb6)

 

Fig 2. Hashes captured from shadow file.
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/15499af6-3a4d-4ccf-9da1-3d53544b768c)
 

Fig 3. John the Ripper
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/44851b35-7705-4386-a8a9-b9e92f3f16c2)
 

Affected Hosts: megacorpone.com

Remediation: 
•	Password policies such as longer passwords.
•	Implement multi-factor authentication.
•	Create a strong password policy (12 characters, numbers, symbols, letters, phrases)
•	Provide password requirement training to all system users. 
•	Use an SIEM to monitor activity to catch unusual amounts of login attempts.


Privilege Escalation & Persistence

Risk Rating: Critical 

Description: We initiated a service to run in the background to enable us to run the exploit of “exploit(windows/local/persistence_service)” in Fig 1. Then continued by setting up the exploit’s options including the session in Fig 2. In Fig 3 we ran the exploit against Windows 10 machine, and got the User ID. In Fig 4 We setup the payload, and in Fig 5 we got the list on the shell. Within Fig 6 we renamed the REMOTE_EXE_NAME to explorer.exe to avoid being detected on the system so the exploit does not lose connection. 

Fig 1. Background service, persistence exploit
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/30b5c30c-aee6-4deb-9925-d8bc22aa06e4)
 

Fig 2. Persistence options, set sessions.
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/40b187a9-4370-403c-b9d9-76a67bbf4429)
 


Fig 3. Run exploit against Windows 10 machine, and get User ID.
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/0041a419-c4ec-4838-8c18-e5d48d9784e9)
 



Fig 4. Setup the payload
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/b655bb1d-20ac-48e8-8414-955b6a2dd111)
 

Fig 5. Shell list

![image](https://github.com/ReVampHer/pentest-report/assets/98286483/133f1246-2c75-40ed-bfe0-84c63639ea37)
 

Fig 6. Renamed the REMOTE_EXE_NAME to explorer.exe to avoid being detected on the system. 
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/0d5c63be-4f38-40e7-8b67-b14bc47cc231)
 

Remediation: 
•	Notify someone if the system is running slow there may be a fake service running in background. 
•	Update the User list to make sure there are no old accounts to exploit.
•	Change default credentials and use a password management system.
•	Enforce least privilege for users, applications, and machines via hardening of them.
•	Monitor privileged sessions and/or lateral movement.
•	Perform patches and fix any misconfigurations.


Site Profile from Shodan.io and recon-ng

Risk Rating: Critical 

Description: The IP address was obtained by performing a nslookup Fig 1 and verified with the use of shodan.io. Fig 2 along with more details of open ports, SSH version, server information, certificate information, and CVEs for your server. We have listed the CVEs Fig 3 here and clickable for your convenience. 
After gathering sensitive information from the Shodan.io profile we used recon-ng to find files, and other useful sensitive information in Fig 4 Recon-ng with Shodan.IO_API, Fig 5 Recon-ng Host, and IP addresses, Fig 6a Recon-ng Reconnaissance Report, and Fig 6b Recon-ng Reconnaissance Report Continued.


Affected Hosts: Apache Server
 

Fig 1. nslookup to obtain company IP address.

![image](https://github.com/ReVampHer/pentest-report/assets/98286483/479196a1-ebd1-4353-976a-8f520721ac0f)
 


Fig 2. Shodan.io company profile
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/bff3aea4-f701-40b6-939d-4faa38922ead)

 
Fig 3. Listed Exploits:
Can be seen on Shodan.io (not including in repository)

Fig 4. Recon-ng with Shodan.IO_API
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/29c5335e-e9f4-46b4-9718-85cd6ee9c255)
 


Fig 5. Recon-ng Host, and IP addresses
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/3488dceb-8f6d-4179-9fb8-a5dec78ae9f9)
 

Fig 6a. Recon-ng Reconnaissance Report 
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/254031f2-cf4f-4437-96a6-71dc2459a128)



Fig 6b. Recon-ng Reconnaissance Report Continued
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/d5ebd085-87a3-4447-9358-fdaab1dbae3c)
 

Remediation: 
•	The CVEs listed are publicly known vulnerabilities, and we did not test the list against your server. But we do suggest that you learn about these vulnerabilities and check your server for them. If you would like us to perform these vulnerability checks, please let us know and we can start another agreement.


Credential Dumping & Lateral Movement 

Risk Rating: High 

Description: My team loaded Mimikatz Kiwi as seen in Fig 1, an extension in Metasploit’s meterpreter to perform dumping of passwords, and hashes with “kiwi_cmd Isadump::cache” seen in Fig 2. Also, in Fig 2 the credential Dumping, and “bbanner” user’s password were cracked for lateral movement using “John the Ripper’. Fig 3 shows the rest of the credential dumping that could not be seen in Fig 2.


Fig 1. Loaded Kiwi  
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/c19a570b-a39c-428d-92ff-0ead1a284d31)


Fig 2. Credential Dumping, and “bbanner” cracked for lateral movement.
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/78dec41e-8eae-4be3-8974-7152d114ee06)
 

Fig 3, Credential Dumping continued
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/ef9a3d02-45a3-4c0b-882b-5bbcd1062ed9)
 

Affected Hosts: megacorpone.com


Remediation: 
•	Encrypt data temporarily stored in memory during development.
•	Use a security tool to harden the system.
•	Limit how many accounts have administrative rights.
•	Use an SIEM (security information and event management)
•	Use multi-factor authentication.

Bash Reverse Shell Vulnerability

Risk Rating: High 

Description: We used “msfvenom” to start a listener port on our attack machine Fig 1, on your target machine we used Bash to connect back to the listener. Fig 2 shows listener port on our attack machine on the right using Metasploit that enables us to use the exploit “exploit(multi/handler)” to use a payload of “windows/meterpreter/reverse_tcp”. This created a reverse shell attack bypassing the firewalls, also passing the port and network address translation all while using port 4444 on the target machine on the left. 

Fig 1. msfvenom

![image](https://github.com/ReVampHer/pentest-report/assets/98286483/8b2f8be1-10ba-414d-b5d0-3ab6cf1ff95f)
 

Fig 2. shows both machines: Listener port on our attack machine on the right, and the target machine on the left.
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/8328de5b-1950-4a0f-bdb5-e41231ccb288)
 

Affected Hosts: megacorpone.com

Remediation: 
•	Use a Firewall to block external traffic.
•	Close unused ports 
•	Monitor network traffic with an intrusion detection system (IDS).
•	Perform a scheduled patch of all the web applications to avoid vulnerabilities. 
•	Never run applications as the “root” user.
•	Remove unnecessary Window services.


Team’s Contact Information on Company Website

Risk Rating: Medium 

Description:
The website displays information about each executive including their pictures. It breaks it down into teams which include full names, titles, and email in Fig 1, Fig 2, and Fig 3. This will make easy targets for hackers to perform whaling. The team used Google Dorking to acquire this information.

Fig 1. Email Information
 ![image](https://github.com/ReVampHer/pentest-report/assets/98286483/754d95b1-286e-48af-9869-0bd103c9d4c2)


Fig 2. Direct emails for Joe, Mike, and Alan
 ![image](https://github.com/ReVampHer/pentest-report/assets/98286483/e245b315-6a9e-4c4c-b71d-ebd7168f0838)




Fig 3. Direct emails for Tom, Tanya, and Matt
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/4a677b1d-be3e-4270-be10-cbe188357408)
 


Remediation: 
•	Remove all direct contact emails from the company’s website.
•	Create a public facing email address or per department.

Vulnerability to Password Spraying

Risk Rating: Medium 

Description:
We used SMB protocol, and Metasploit with the auxiliary(scanner/smb/smb_login) Fig 1, and Fig 2 are the options to perform the spray attack. The options were set from the credentials previously cracked from /etc/shadow file. In Fig 3 we display the target’s system information.

Fig 1. bbanner’s Administrator login credential.
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/8e91eafd-f19a-4fb0-8612-704bb424089e)
 

Fig 2. Background tstark and set parameters for bbanner.
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/cd9e7915-5d76-463a-9958-7ce682c8dd09)
 


Fig 3. System information
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/2120e287-bf02-4cd4-b33b-f7ae7a7dd68b)
 


Remediation: 
•	Require everyone to change and update passwords.
•	Set requirements for passwords.
•	Implement multi-factor authentication.
•	Implement an Audit Incident Response Plan
•	Eliminate commonly used passwords by enabling Active Directory Password Protection.
•	Remove passwords throughout organization and replace with biometrics.

Server Details, and the Robots.txt file configuration

Risk Rating: Low

Description:
The website displayed the server information using Apache 2.4.38 on a Debian distro through port 80. Shown by (Figure 3). The server displayed the robots.txt file. We got full access to the structure of the website as seen in (Figure 5). Through this information an attacker has access to any known exploits they can find against the server, and port. 

Remediation: 
•	Configurations of the robots.txt file should be changed to not include areas of the site.

Fig 1. attempt 1 on intext assets.
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/8a7a55c0-4d7b-4b1d-9915-cfc11900b53e)
 

Fig 2. attempt 2 on intext assets.
 ![image](https://github.com/ReVampHer/pentest-report/assets/98286483/d3fcac02-0aff-4abb-ac9a-0e9d32f56f36)



Fig 3. Index of assets with Operating System version and port used for server.
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/9049f0d2-2b04-4561-8705-afe8faccd0d1)
 


Fig 4. Extension: text file
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/c68a4eed-b0b5-4516-aeb5-0154279585cf)
 

Fig 5. Robots.txt file
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/ef29adfd-c2a3-4581-ab53-4cc1dc8364cb)
 

Fig 6. Bonus: Robots I am not a bot information
![image](https://github.com/ReVampHer/pentest-report/assets/98286483/5a9ff976-da1e-4472-af8d-846bbece5e7d)
 

Fig 7. Nanites.php

![image](https://github.com/ReVampHer/pentest-report/assets/98286483/1963c5d1-8fe6-4fe9-86e0-511c2fbc69d5)
 




MITRE ATT&CK Navigator Map

The following completed MITRE ATT&CK navigator map shows all the techniques and tactics that SC used throughout the assessment.


Legend

Performed Successfully =(Yellow)

Failure to Perform =(RED)	

![image](https://github.com/ReVampHer/pentest-report/assets/98286483/2d513175-2a56-4a9d-83d1-2afb55b5d886)


![image](https://github.com/ReVampHer/pentest-report/assets/98286483/6c87137d-59f0-47d7-a00c-91041ad38727)


